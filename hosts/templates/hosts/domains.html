{% extends "base.html" %}
{# kate: space-indent on; indent-width 2; replace-tabs on; hl Django HTML Template; #}
{% load mptt_tags %}
{% load display_extras %}
{% load monitoring_extras %}
{% block title %}Domains &mdash; Fluxmon{% endblock %}
{% block content %}
<ul class="children">
  {% recursetree nodes %}
    {% if not node.is_root_node %}
      <li>
        <a href="{% url 'hosts.views.domain' node.id %}">{{ node }}</a> ({{ node.host_set.count }} Host{{ node.host_set.count|pluralize }})
        (<a href="{% url 'hosts.views.add_host' node.id %}">+</a>)
        {% if node.host_set.count %}
          <ul>
            {% for host in node.get_hosts %}
              {% ifperm "r" on host %}
                <li><a href="{% url 'hosts.views.host' host.fqdn %}">{{ host }}</a></li>
              {% endifperm %}
            {% endfor %}
          </ul>
        {% endif %}
      </li>
    {% endif %}
    {% if not node.is_leaf_node %}
      <ul class="children">
        {{ children }}
      </ul>
    {% endif %}
  {% endrecursetree %}
</ul>
{% endblock %}
