{% extends "base.html" %}
{% load display_extras %}
{% load monitoring_extras %}
{# kate: space-indent on; indent-width 2; replace-tabs on; hl Django HTML Template; #}
{% block title %}Fluxmon &mdash; {{ check.target_host|display:"fqdn" }} &mdash; {% for checkparam in check.checkparameter_set.all %}{{ checkparam.parameter|display }}: {{ checkparam.value }}{% endfor %}{% endblock %}
{% block content %}
<ol class="breadcrumb">
  <li><a href="{% url hosts.views.domains %}">Hosts</a></li>
  <li>
    <a href="{% url hosts.views.host check.target_host.fqdn %}">{{ check.target_host|display:"fqdn" }}</a>
    {% if check.target_host != check.exec_host %}(as seen by <a href="{% url hosts.views.host check.exec_host.fqdn %}">{{ check.exec_host|display:"fqdn" }}</a>){% endif %}
  </li>
  <li class="active">{{ check|display:"uuid" }}</li>
</ol>
{% include "monitoring/checkinfo.inc.html" %}
<ul class="nav nav-tabs">
  <li><a href="#variables" data-toggle="tab">Variables</a></li>
  {% ifperm "a" on check %}
  <li><a href="#acls"      data-toggle="tab">ACLs</a></li>
  {% endifperm %}
  {% ifperm "s" on check %}
  <li><a href="#share"     data-toggle="tab">Share</a></li>
  {% endifperm %}
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="variables">
    <table class="table table-hover">
      <tbody>
      {% for variable, alerts in vars %}
        <tr targetlink="{% url monitoring.views.render_check_page check.uuid variable.name %}" class="checktr {% if alerts %}warning{% else %}success{% endif %}">
          <td>
            {{ variable|display }}
          </td>
          <td><a href="{% url monitoring.views.render_check_page check.uuid variable.name %}" title="View graph" style="text-decoration: none">â†’</a></td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  {% ifperm "a" on check %}
  <div class="tab-pane" id="acls">
    {% for origin, acl in check.all_acls %}
      {% if origin != check %}
        <b>Inherited from {{ origin }}</b>
      {% else %}
        <b>Defined here</b>
      {% endif %}
      {% include "fluxacl/acl.html" %}
    {% empty %}
      No ACLs are defined for this check.
    {% endfor %}
  </div>
  {% endifperm %}

  {% ifperm "a" on check %}
  <div class="tab-pane" id="share">
    If it were implemented, you could share stuffz nao.
  </div>
  {% endifperm %}
</div>
<script type="text/javascript">
$(".checktr").click(function(ev){
  ev.preventDefault();
  ev.stopPropagation();
  if(ev.ctrlKey){
    window.open(this.attributes.targetlink.value);
  }
  else{
    window.location = this.attributes.targetlink.value;
  }
});
</script>
{% endblock %}
