{# kate: space-indent on; indent-width 2; replace-tabs on; hl Django HTML Template; #}
{% load display_extras %}
{% if acl %}
<table class="table table-hover">
  <thead>
    <tr>
      <th>Role</th>
      <th>Permissions</th>
      <th>Validity</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
  {% for permit in acl.permit_set.all %}
    <tr>
      <td>
        {% if permit.role.token %}
          <a href="?token={{ permit.role.token }}">
            {{ permit.role }}
          </a>
        {% else %}
          {{ permit.role }}
        {% endif %}
      </td>
      <td>{{ permit.privileges }}</td>
      <td>
        {% if not permit.role.is_active %}
          Expired
        {% elif permit.role.valid_until %}
          Valid until {{ permit.role.valid_until }} ({{ permit.role.valid_until|timeuntil }})
        {% else %}
          Unlimited
        {% endif %}
      </td>
      <td><a href="#" title="View details" style="text-decoration: none">â†’</a></td>
    </tr>
  {% endfor %}
  </tbody>
</table>
<script type="text/javascript">
$(".checktr").click(function(ev){
  ev.preventDefault();
  ev.stopPropagation();
  if(ev.ctrlKey){
    window.open(this.attributes.targetlink.value);
  }
  else{
    window.location = this.attributes.targetlink.value;
  }
});
</script>
{% endif %}
